Prompt para Claude Code - Formulario Registro de Ventas v2
Claude, necesito reformular completamente el formulario de Registro de Ventas en GridRetail.

## CONTEXTO GENERAL

Este formulario registra ventas declarativas (Boca de Urna) que luego se cruzan con el INAR de Entel para validaciÃ³n y cÃ¡lculo de comisiones. La tienda ya estÃ¡ seleccionada (tienda_activa en localStorage).

## ARCHIVOS A CREAR/MODIFICAR

### 1. CREAR: lib/constants/tipos-venta.ts
```typescript
export const TIPOS_VENTA = [
  // PORTABILIDAD OSS
  { codigo: 'OSS_BASE', nombre: 'Porta OSS - Base', categoria: 'POSTPAGO', requiereCedente: true, requiereImei: false, permiteSeguro: false, ayuda: 'Portabilidad de cliente con >30 dÃ­as en Entel' },
  { codigo: 'OSS_CAPTURA', nombre: 'Porta OSS - Captura', categoria: 'POSTPAGO', requiereCedente: true, requiereImei: false, permiteSeguro: false, ayuda: 'Portabilidad de cliente nuevo en Entel' },
  
  // PORTABILIDAD OPP
  { codigo: 'OPP_MONO', nombre: 'Porta OPP Mono', categoria: 'POSTPAGO', requiereCedente: true, requiereImei: false, permiteSeguro: false, ayuda: 'Cliente nuevo, primera o Ãºnica lÃ­nea portada' },
  { codigo: 'OPP_CAPTURA', nombre: 'Porta OPP Captura', categoria: 'POSTPAGO', requiereCedente: true, requiereImei: false, permiteSeguro: false, ayuda: 'Cliente nuevo, 2da lÃ­nea portada en adelante' },
  { codigo: 'OPP_LLAA', nombre: 'Porta OPP LLAA', categoria: 'POSTPAGO', requiereCedente: true, requiereImei: false, permiteSeguro: false, ayuda: 'Cliente BASE (>30 dÃ­as) porta lÃ­nea adicional' },
  
  // VENTA REGULAR
  { codigo: 'VR_MONO', nombre: 'VR Mono', categoria: 'POSTPAGO', requiereCedente: false, requiereImei: false, permiteSeguro: false, ayuda: 'Cliente nuevo, primera o Ãºnica lÃ­nea' },
  { codigo: 'VR_CAPTURA', nombre: 'VR Captura', categoria: 'POSTPAGO', requiereCedente: false, requiereImei: false, permiteSeguro: false, ayuda: 'Cliente nuevo, 2da lÃ­nea en adelante' },
  { codigo: 'VR_LLAA', nombre: 'VR LLAA', categoria: 'POSTPAGO', requiereCedente: false, requiereImei: false, permiteSeguro: false, ayuda: 'Cliente BASE (>30 dÃ­as), lÃ­nea adicional' },
  
  // MISS IN
  { codigo: 'MISS_IN', nombre: 'Miss In (Preâ†’Pos Entel)', categoria: 'POSTPAGO', requiereCedente: false, requiereImei: false, permiteSeguro: false, ayuda: 'LÃ­nea Prepago Entel se convierte a Pospago' },
  
  // PACK SS
  { codigo: 'PACK_OSS', nombre: 'Pack Porta OSS', categoria: 'PACK_SS', requiereCedente: true, requiereImei: true, permiteSeguro: true, ayuda: 'Portabilidad OSS con equipo incluido' },
  { codigo: 'PACK_VR', nombre: 'Pack VR', categoria: 'PACK_SS', requiereCedente: false, requiereImei: true, permiteSeguro: true, ayuda: 'Venta Regular con equipo incluido' },
  
  // RENOVACIÃ“N
  { codigo: 'RENO', nombre: 'RenovaciÃ³n Equipo', categoria: 'RENO', requiereCedente: false, requiereImei: true, permiteSeguro: true, ayuda: 'RenovaciÃ³n de equipo (valida con Ficha de Comisiones)' },
  
  // PREPAGO
  { codigo: 'PREPAGO', nombre: 'Venta Prepago', categoria: 'PREPAGO', requiereCedente: false, requiereImei: false, permiteSeguro: false, ayuda: 'Venta de chip prepago' },
  { codigo: 'PORTA_PP', nombre: 'Portabilidad Prepago', categoria: 'PREPAGO', requiereCedente: true, requiereImei: false, permiteSeguro: false, ayuda: 'Portabilidad de prepago de otro operador' },
  
  // OTROS
  { codigo: 'ACCESORIOS', nombre: 'Solo Accesorios', categoria: 'OTROS', requiereCedente: false, requiereImei: false, permiteSeguro: false, ayuda: 'Venta solo de accesorios (sin lÃ­nea)' },
]

export const CATEGORIAS = ['POSTPAGO', 'PACK_SS', 'RENO', 'PREPAGO', 'OTROS']

export const RANGOS_HORARIOS = [
  { codigo: '08', nombre: '08:00 - 08:59' },
  { codigo: '09', nombre: '09:00 - 09:59' },
  { codigo: '10', nombre: '10:00 - 10:59' },
  { codigo: '11', nombre: '11:00 - 11:59' },
  { codigo: '12', nombre: '12:00 - 12:59' },
  { codigo: '13', nombre: '13:00 - 13:59' },
  { codigo: '14', nombre: '14:00 - 14:59' },
  { codigo: '15', nombre: '15:00 - 15:59' },
  { codigo: '16', nombre: '16:00 - 16:59' },
  { codigo: '17', nombre: '17:00 - 17:59' },
  { codigo: '18', nombre: '18:00 - 18:59' },
  { codigo: '19', nombre: '19:00 - 19:59' },
  { codigo: '20', nombre: '20:00 - 20:59' },
  { codigo: '21', nombre: '21:00 - 21:59' },
]

export const TIPOS_DOCUMENTO = [
  { codigo: 'DNI', nombre: 'DNI', patron: /^\d{8}$/, placeholder: '12345678' },
  { codigo: 'CE', nombre: 'CarnÃ© ExtranjerÃ­a', patron: /^\d{9}$/, placeholder: '123456789' },
  { codigo: 'RUC', nombre: 'RUC', patron: /^(10|20)\d{9}$/, placeholder: '10123456789' },
  { codigo: 'PASAPORTE', nombre: 'Pasaporte', patron: /^[A-Z0-9]{6,12}$/i, placeholder: 'AB123456' },
  { codigo: 'PTP', nombre: 'PTP', patron: /^[A-Z0-9]{6,15}$/i, placeholder: 'PTP123456' },
]

// Roles que pueden registrar ventas de fechas anteriores (>1 dÃ­a)
export const ROLES_FECHA_LIBRE = ['ADMIN', 'GERENTE_COMERCIAL', 'JEFE_VENTAS', 'BACKOFFICE_OPERACIONES']

// Roles que NO requieren tienda
export const ROLES_SIN_TIENDA = ['ADMIN', 'GERENTE_GENERAL', 'GERENTE_COMERCIAL', 'BACKOFFICE_OPERACIONES', 'BACKOFFICE_RRHH', 'BACKOFFICE_AUDITORIA', 'CAPACITADOR', 'VALIDADOR_ARRIBOS']
```

### 2. MODIFICAR: app/(dashboard)/dashboard/ventas/nuevo/page.tsx

Reformular completamente el formulario con las siguientes secciones:

## ESTRUCTURA DEL FORMULARIO

### HEADER
- Mostrar: "ðŸ“ Registrando en: [NOMBRE_TIENDA] ([ZONA])"
- Si el rol no tiene tienda asignada, mostrar selector de tienda

### SECCIÃ“N 1: FECHA Y HORA
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“… FECHA Y HORA DE LA VENTA                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  â—‹ Venta de HOY              â—‹ Venta de AYER                   â”‚
â”‚    [fecha automÃ¡tica]           [fecha automÃ¡tica]             â”‚
â”‚    [rango horario auto]         [rango horario SELECT]         â”‚
â”‚                                                                 â”‚
â”‚  (Si AYER):                                                    â”‚
â”‚  âš ï¸ Requiere aprobaciÃ³n y genera incidencia                    â”‚
â”‚  Motivo del rezago: [] (requerido)             â”‚
â”‚                                                                 â”‚
â”‚  (Si rol en ROLES_FECHA_LIBRE, mostrar tercera opciÃ³n):        â”‚
â”‚  â—‹ Otra fecha                                                  â”‚
â”‚    [date picker hasta 30 dÃ­as atrÃ¡s]                           â”‚
â”‚    [rango horario SELECT]                                      â”‚
â”‚    Motivo: []                                  â”‚
â”‚    â˜ Registrar para otro asesor                                â”‚
â”‚      [SELECT asesor de la tienda/zona]                         â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LÃ³gica:
- HOY: fecha = hoy, rango_horario = hora actual (automÃ¡tico, no editable)
- AYER: fecha = ayer, rango_horario = SELECT requerido, motivo requerido, estado = 'pendiente_aprobacion', es_venta_rezagada = true
- OTRA FECHA: Solo roles en ROLES_FECHA_LIBRE

### SECCIÃ“N 2: ORDEN DE VENTA (con verificaciÃ³n inteligente)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ” ORDEN DE VENTA                                              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  NÃºmero de Orden *                                             â”‚
â”‚  [_______________] [Verificar]                                 â”‚
â”‚                                                                 â”‚
â”‚  Validaciones:                                                 â”‚
â”‚  - 9 dÃ­gitos, empieza con 7                                    â”‚
â”‚  - Si estÃ¡ muy lejos del correlativo â†’ advertencia             â”‚
â”‚                                                                 â”‚
â”‚  (Si la orden YA existe en ventas de hoy):                     â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ â„¹ï¸ Esta orden ya tiene lÃ­neas registradas:               â”‚   â”‚
â”‚  â”‚ â€¢ 987654321 | VR_MONO | 10:30 AM | Por: JPEREZ          â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ Cliente: JUAN CARLOS PEREZ RODRIGUEZ                    â”‚   â”‚
â”‚  â”‚ DNI: 12345678                                           â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ [Agregar otra lÃ­nea a esta orden]                       â”‚   â”‚
â”‚  â”‚ [Cancelar - ingresÃ© mal el nÃºmero]                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

LÃ³gica:
- Al ingresar orden y presionar "Verificar" o perder foco:
  1. Validar formato (9 dÃ­gitos, empieza con 7)
  2. Buscar en BD si existe la orden en ventas del dÃ­a
  3. Si existe: mostrar datos del cliente y lÃ­neas, permitir "Agregar otra lÃ­nea"
  4. Si es lÃ­nea adicional: heredar datos del cliente (readonly)

### SECCIÃ“N 3: IDENTIFICACIÃ“N (solo si orden es nueva o agregando lÃ­nea)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ‘¤ DATOS DE IDENTIFICACIÃ“N                                     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  TelÃ©fono / LÃ­nea *          (siempre editable)                â”‚
â”‚  []                                                 â”‚
â”‚  â„¹ï¸ 9 dÃ­gitos, empieza con 9                                   â”‚
â”‚                                                                 â”‚
â”‚  (Los siguientes son readonly si es lÃ­nea adicional):          â”‚
â”‚                                                                 â”‚
â”‚  Tipo Documento *            NÃºmero Documento *                â”‚
â”‚  [DNI â–¼]                     []                     â”‚
â”‚                                                                 â”‚
â”‚  Nombre del Cliente *                                          â”‚
â”‚  [________________________________]                            â”‚
â”‚  â„¹ï¸ Como aparece en el documento                               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### SECCIÃ“N 4: CLASIFICACIÃ“N
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“Š CLASIFICACIÃ“N DE LA VENTA                                   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  Tipo de Venta *                    [?] â† Icono ayuda          â”‚
â”‚  [SELECT agrupado por categorÃ­a]                               â”‚
â”‚                                                                 â”‚
â”‚  Al hacer hover o click en [?]:                                â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚ VENTA REGULAR (VR):                                     â”‚   â”‚
â”‚  â”‚ â€¢ VR_MONO: Cliente NUEVO, primera o Ãºnica lÃ­nea         â”‚   â”‚
â”‚  â”‚ â€¢ VR_CAPTURA: Cliente NUEVO, 2da lÃ­nea en adelante      â”‚   â”‚
â”‚  â”‚ â€¢ VR_LLAA: Cliente BASE (>30 dÃ­as en Entel)             â”‚   â”‚
â”‚  â”‚                                                         â”‚   â”‚
â”‚  â”‚ PORTABILIDAD:                                           â”‚   â”‚
â”‚  â”‚ â€¢ OSS = Origen Pospago (del otro operador)              â”‚   â”‚
â”‚  â”‚ â€¢ OPP = Origen Prepago (del otro operador)              â”‚   â”‚
â”‚  â”‚ â€¢ BASE = Cliente con >30 dÃ­as en Entel                  â”‚   â”‚
â”‚  â”‚ â€¢ CAPTURA = Cliente nuevo en Entel                      â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚                                                                 â”‚
â”‚  (Si tipo requiere cedente - OSS_, OPP_, PORTA_PP):          â”‚
â”‚  Operador Cedente *                                            â”‚
â”‚  [MOVISTAR â–¼]  (cargar de tabla operadores_cedentes)           â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### SECCIÃ“N 5: EQUIPO Y SEGURO (condicional)
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“± EQUIPO Y SEGURO                                             â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  (Visible si tipo = PACK_, RENO, o permite equipo)            â”‚
â”‚                                                                 â”‚
â”‚  IMEI Equipo *               Modelo Equipo                     â”‚
â”‚  []           []                 â”‚
â”‚  â„¹ï¸ 15 dÃ­gitos                                                 â”‚
â”‚                                                                 â”‚
â”‚  (Si tipo permite seguro - PACK_, RENO):                      â”‚
â”‚  â˜ Incluye Seguro MEP                                          â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚  (Si tipo NO es RENO ni ACCESORIOS - tiene chip):              â”‚
â”‚  ICCID Chip                                                    â”‚
â”‚  []                                     â”‚
â”‚  â„¹ï¸ 19-20 dÃ­gitos (opcional)                                   â”‚
â”‚                                                                 â”‚
â”‚  â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€  â”‚
â”‚                                                                 â”‚
â”‚  (Siempre visible):                                            â”‚
â”‚  â˜ Incluye accesorios                                          â”‚
â”‚                                                                 â”‚
â”‚  (Si marca accesorios):                                        â”‚
â”‚  DescripciÃ³n Accesorios                                        â”‚
â”‚  [_________]                            â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### SECCIÃ“N 6: OBSERVACIONES
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ðŸ“ OBSERVACIONES (opcional)                                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                                 â”‚
â”‚  [textarea - max 500 caracteres]                               â”‚
â”‚                                                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

### BOTONES DE ACCIÃ“N
[Registrar Venta]  [Limpiar Formulario]
DespuÃ©s de guardar exitoso:

Toast: "âœ… Venta registrada correctamente"
Mostrar resumen con opciÃ³n: [Registrar otra venta] [Ver mis ventas]


## LÃ“GICA DE GUARDADO
```typescript
const guardarVenta = async (values) => {
  const usuario = getUsuarioFromLocalStorage()
  const tiendaActiva = getTiendaActiva()
  
  // Determinar estados segÃºn fecha
  const esHoy = values.fecha === hoy
  const esAyer = values.fecha === ayer
  const esRezagada = !esHoy
  
  // Determinar categorÃ­a y fuente de validaciÃ³n
  const tipoConfig = TIPOS_VENTA.find(t => t.codigo === values.tipo_venta)
  
  const ventaData = {
    // AutomÃ¡ticos
    tienda_id: tiendaActiva?.id || values.tienda_id,
    usuario_id: values.asesor_real_id || usuario?.id,
    codigo_asesor: values.asesor_real_codigo || usuario?.codigo_asesor,
    registrado_por: usuario?.id,
    
    // Fecha y hora
    fecha: values.fecha,
    rango_horario: values.rango_horario,
    timestamp_registro: new Date().toISOString(),
    es_venta_rezagada: esRezagada,
    motivo_rezago: esRezagada ? values.motivo_rezago : null,
    
    // Estado
    estado: esRezagada && !ROLES_FECHA_LIBRE.includes(usuario?.rol) 
      ? 'pendiente_aprobacion' 
      : 'registrada',
    
    // IdentificaciÃ³n
    orden_venta: values.orden_venta,
    telefono_linea: values.telefono_linea,
    tipo_documento_cliente: values.tipo_documento,
    numero_documento_cliente: values.numero_documento,
    nombre_cliente: values.nombre_cliente,
    
    // ClasificaciÃ³n
    tipo_venta: values.tipo_venta,
    categoria_venta: tipoConfig?.categoria,
    fuente_validacion: tipoConfig?.fuenteValidacion,
    operador_cedente: values.operador_cedente || null,
    
    // Equipo
    imei_equipo: values.imei_equipo || null,
    modelo_equipo: values.modelo_equipo || null,
    iccid_chip: values.iccid_chip || null,
    
    // Seguro
    incluye_seguro: values.incluye_seguro || false,
    tipo_seguro: values.tipo_seguro || null,
    
    // Accesorios
    incluye_accesorios: values.incluye_accesorios || false,
    descripcion_accesorios: values.descripcion_accesorios || null,
    
    // Otros
    notas: values.notas || null,
    estado_cruce: 'PENDIENTE',
  }
  
  // Guardar
  const { data, error } = await supabase
    .from('ventas')
    .insert(ventaData)
    .select()
    .single()
  
  // Si es rezagada, crear incidencia
  if (esRezagada && data) {
    await supabase.from('asesor_incidencias').insert({
      usuario_id: ventaData.usuario_id,
      tipo_incidencia: 'VENTA_REZAGADA',
      puntos: 1,
      fecha: ventaData.fecha,
      detalle: `Venta del ${values.fecha} registrada el ${hoy}. Motivo: ${values.motivo_rezago}`,
      referencia_tipo: 'venta',
      referencia_id: data.id,
      registrado_por: usuario?.id,
    })
  }
  
  return data
}
```

## API ENDPOINTS NECESARIOS

### 3. CREAR: app/api/ventas/verificar-orden/route.ts
Endpoint para verificar si una orden ya existe:
```typescript
// GET /api/ventas/verificar-orden?orden=712345678&fecha=2026-01-15
// Response si existe:
{
  existe: true,
  lineas: [
    { telefono: '987654321', tipo_venta: 'VR_MONO', rango_horario: '10', asesor: 'JPEREZ' }
  ],
  cliente: {
    nombre: 'JUAN CARLOS PEREZ RODRIGUEZ',
    tipo_documento: 'DNI',
    numero_documento: '12345678'
  }
}
// Response si no existe:
{ existe: false }
```

### 4. CREAR: app/api/operadores-cedentes/route.ts
Endpoint para obtener lista de operadores cedentes activos.

## VALIDACIONES CON ZOD
```typescript
const ventaSchema = z.object({
  // Fecha
  fecha: z.string(),
  rango_horario: z.string().length(2),
  motivo_rezago: z.string().optional(),
  
  // Orden
  orden_venta: z.string()
    .regex(/^7\d{8}$/, 'Debe ser 9 dÃ­gitos y empezar con 7'),
  
  // IdentificaciÃ³n
  telefono_linea: z.string()
    .regex(/^9\d{8}$/, 'Debe ser 9 dÃ­gitos y empezar con 9'),
  tipo_documento: z.enum(['DNI', 'CE', 'RUC', 'PASAPORTE', 'PTP']),
  numero_documento: z.string().min(6).max(15),
  nombre_cliente: z.string().min(3).max(100),
  
  // ClasificaciÃ³n
  tipo_venta: z.string(),
  operador_cedente: z.string().optional(),
  
  // Equipo
  imei_equipo: z.string().regex(/^\d{15}$/).optional().or(z.literal('')),
  modelo_equipo: z.string().optional(),
  iccid_chip: z.string().regex(/^\d{19,20}$/).optional().or(z.literal('')),
  
  // Seguro y accesorios
  incluye_seguro: z.boolean().default(false),
  incluye_accesorios: z.boolean().default(false),
  descripcion_accesorios: z.string().optional(),
  
  // Otros
  notas: z.string().max(500).optional(),
}).refine((data) => {
  // Validar documento segÃºn tipo
  const tipoDoc = TIPOS_DOCUMENTO.find(t => t.codigo === data.tipo_documento)
  return tipoDoc?.patron.test(data.numero_documento)
}, {
  message: 'Formato de documento invÃ¡lido',
  path: ['numero_documento']
}).refine((data) => {
  // Si es rezagada, requiere motivo
  const hoy = new Date().toISOString().split('T')[0]
  if (data.fecha < hoy && !data.motivo_rezago) {
    return false
  }
  return true
}, {
  message: 'Debe indicar el motivo del registro tardÃ­o',
  path: ['motivo_rezago']
})
```

## DISEÃ‘O UI

- Usar shadcn/ui components
- Layout responsivo: 2 columnas en desktop para campos cortos
- Secciones con Card y CardHeader
- Campos obligatorios con asterisco rojo
- Tooltips de ayuda con icono (?)
- Select agrupados por categorÃ­a para tipo_venta
- Toast para mensajes de Ã©xito/error
- Skeleton loading mientras verifica orden
- Badges para estados (pendiente_aprobacion = amarillo, registrada = verde)

Implementa todos estos cambios.